<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8" />
		<title></title>
		<link rel="stylesheet" href="css/heart.css" />
		<link rel="stylesheet" href="css/animate.min.css">
		<link rel="stylesheet" type="text/css" href="css/reset.min.css" />
		<link href="https://fonts.googleapis.com/css?family=Anton|Ranga" rel="stylesheet">
		<link rel="stylesheet" type="text/css" href="css/Style.css" />
		<link rel="stylesheet" type="text/css" href="css/index-main.css" />
		<link href="https://fonts.googleapis.com/css?family=Cairo|Great+Vibes" rel="stylesheet">
		<script src="js/jquery-3.2.1.min.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript" src="js/ThreeWebGL.js"></script>
		<script type="text/javascript" src="js/ThreeExtras.js"></script>
		<script type="text/javascript" src="js/Detector.js"></script>
		<script src="js/stars.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript" src="js/RequestAnimationFrame.js"></script>
		<script src="js/star.js" type="text/javascript" charset="utf-8"></script>
		<!--<script src="js/55ac9ea30001ace700000000.js" type="text/javascript"></script>-->

	</head>

	<body class="b_background4">
		<audio id="bgm" src="css/bgm0.mp3" autoplay="true" loop="true"></audio>
		<div class="stars"></div>
		<script id="vs" type="x-shader/x-vertex">

			varying vec2 vUv; void main() { vUv = uv; gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 ); }

		</script>
		<script id="fs" type="x-shader/x-fragment">

			uniform sampler2D map; uniform vec3 fogColor; uniform float fogNear; uniform float fogFar; varying vec2 vUv; void main() { float depth = gl_FragCoord.z / gl_FragCoord.w; float fogFactor = smoothstep( fogNear, fogFar, depth ); gl_FragColor = texture2D( map, vUv ); gl_FragColor.w *= pow( gl_FragCoord.z, 20.0 ); gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor ); }

		</script>
		<script type="text/javascript">
			if(!Detector.webgl) Detector.addGetWebGLMessage();

			// Bg gradient

			var canvas = document.createElement('canvas');

			canvas.width = 32;

			canvas.height = window.innerHeight;

			var context = canvas.getContext('2d');

			var gradient = context.createLinearGradient(0, 0, 0, canvas.height);

			gradient.addColorStop(0, "#1e4877");

			gradient.addColorStop(0.5, "#4584b4");

			context.fillStyle = gradient;

			context.fillRect(0, 0, canvas.width, canvas.height);

			//document.body.style.background = 'url(' + canvas.toDataURL('image/png') + ')';

			// Clouds

			var container;

			var camera, scene, renderer, sky, mesh, geometry, material,

				i, h, color, colors = [],
				sprite, size, x, y, z;

			var mouseX = 0,
				mouseY = 0;

			var start_time = new Date().getTime();

			var windowHalfX = window.innerWidth / 2;

			var windowHalfY = window.innerHeight / 2;

			init();

			animate();

			function init() {

				container = document.createElement('div');

				document.body.appendChild(container);

				camera = new THREE.Camera(30, window.innerWidth / window.innerHeight, 1, 3000);

				camera.position.z = 6000;

				scene = new THREE.Scene();

				geometry = new THREE.Geometry();

				var texture = THREE.ImageUtils.loadTexture('cloud.png');

				texture.magFilter = THREE.LinearMipMapLinearFilter;

				texture.minFilter = THREE.LinearMipMapLinearFilter;

				var fog = new THREE.Fog(0x4584b4, -100, 3000);

				material = new THREE.MeshShaderMaterial({

					uniforms: {

						"map": {
							type: "t",
							value: 2,
							texture: texture
						},

						"fogColor": {
							type: "c",
							value: fog.color
						},

						"fogNear": {
							type: "f",
							value: fog.near
						},

						"fogFar": {
							type: "f",
							value: fog.far
						},

					},

					vertexShader: document.getElementById('vs').textContent,

					fragmentShader: document.getElementById('fs').textContent,

					depthTest: false

				});

				var plane = new THREE.Mesh(new THREE.Plane(64, 64));

				for(i = 0; i < 8000; i++) {

					plane.position.x = Math.random() * 1000 - 500;

					plane.position.y = -Math.random() * Math.random() * 200 - 15;

					plane.position.z = i;

					plane.rotation.z = Math.random() * Math.PI;

					plane.scale.x = plane.scale.y = Math.random() * Math.random() * 1.5 + 0.5;

					GeometryUtils.merge(geometry, plane);

				}

				mesh = new THREE.Mesh(geometry, material);

				scene.addObject(mesh);

				mesh = new THREE.Mesh(geometry, material);

				mesh.position.z = -8000;

				scene.addObject(mesh);

				renderer = new THREE.WebGLRenderer({
					antialias: false
				});

				renderer.setSize(window.innerWidth, window.innerHeight);

				container.appendChild(renderer.domElement);

				document.addEventListener('mousemove', onDocumentMouseMove, false);

				window.addEventListener('resize', onWindowResize, false);

			}

			function onDocumentMouseMove(event) {

				mouseX = (event.clientX - windowHalfX) * 0.25;

				mouseY = (event.clientY - windowHalfY) * 0.15;

			}

			function onWindowResize(event) {

				camera.aspect = window.innerWidth / window.innerHeight;

				camera.updateProjectionMatrix();

				renderer.setSize(window.innerWidth, window.innerHeight);

			}

			function animate() {

				requestAnimationFrame(animate);

				render();

			}

			function render() {

				position = ((new Date().getTime() - start_time) * 0.03) % 8000;

				camera.position.x += (mouseX - camera.target.position.x) * 0.01;

				camera.position.y += (-mouseY - camera.target.position.y) * 0.01;

				camera.position.z = -position + 8000;

				camera.target.position.x = camera.position.x;

				camera.target.position.y = camera.position.y;

				camera.target.position.z = camera.position.z - 1000;

				renderer.render(scene, camera);

			}
		</script>
		<div id="instructions"></div>
		<canvas id="rain">Canvas is not supported in your browser</canvas>
		<div class="animated slideInDown" id="title">About Love, Lost Lover </div>

		<div>

			<!--<div class="heart heart1"><div id="mixcg"></div><div id="hclady"></div></div>-->
			<div id="mixcg" class='animated slideInLeft'></div>
			<div class="chest">
				<div id="tips">try mouseover sun</div>
				<div class="heart left side top">

				</div>
				<div class="heart center">

				</div>
				<div class="heart right side">

				</div>

			</div>
			<div id="hclady" class='animated slideInRight'></div>
		</div>
		<div id="sun"></div>
		<img  id="lady" />
		<div id="hcym">

			<div class="animated slideInLeft">Yellow</div>
			<div class="animated slideInRight">Morning</div>
			
			<div class="animated slideInRight" id="fish">
				<h2>:<~- </h2><h2><h2>

			</div>
			<div id="subject" class="animated fadeInDown">
				<p>Sometimes Jesus shared Scripture. But mostly He just shared stories. </p><p>I'm not a relentless wind, but you set off a storm. I dare not gaze into your black fascinating
				<a onclick="addSong();"> magic eyes</a>, for I will fallen in abyss.</p>
				<!--My friend asked me about my feelings about secret love. I replied like that I saw a beloved toy. When I had no money to buy, I started to save money. I went to buy and found that the price was increased.when I  harder save money  found it has been already sold to someone else I hope it will not appear in the garbage dump. If I see it, I will still pick it up.-->
			</div>
		</div>
		
		<div id="info"><strong>wwemixcg@gmail.com</strong></div>
		<input id="addsong" type='file' onchange="songlist(this);" name='songs' multiple='multiple' style="display: none;" />
		<script src='js/dat.gui.js'></script>
		<script src="js/index.js"></script>

		<script type="text/javascript">
			var i = 0;
			$("#fish").mouseover(function() {

				$("#mixcg").append("<object class='animated slideInLeft'>MixCG</object>");
				$("#hclady").append("<object class='animated slideInRight'>HC</object>");
			});

			$("#fish ").mouseout(function() {
				$("#mixcg").empty();
				$("#hclady").empty();
				$('#lady').addClass('animated fadeOutLeftBig');
			    setTimeout(function(){
			    	$("#lady").css("display", "none");
			        
			    	$('#lady').removeClass('fadeOutLeftBig');   
			    }, 1000);
				
			});
			
			
			
			$("#fish").dblclick(function() {
				$('#lady').addClass('animated fadeInUp');
			    setTimeout(function(){
			    	$("#lady").css("display", "block");
			       // $('#lady').removeClass('fadeInUp');
			    }, 1000);
				
			});
			
			$("#sun").mouseover(function() {
				i=Math.ceil(Math.random()*18);
				$("#title").css("display", "block");
				$("body").removeClass();
				$("body").addClass('b_background' + i);
				$("#bgm")[0].src = "";
				$("#bgm")[0].src = "css/bgm" + i + ".mp3";
				$("#bgm")[0].play();

				if(i > 18) {
					i = 0;
				} else {
					i = Math.ceil(Math.random()*17);
				}
			})

			$("#sun").mouseout(function() {

				$("#title").css("display", "none");
				if(1 == 1) {
					$("#tips").css("display", "none");
				}

			})

			function time_range(beginTime, endTime, varTime) {
				var strb = beginTime.split(":");
				if(strb.length != 2) {
					return false;
				}
				var stre = endTime.split(":");
				if(stre.length != 2) {
					return false;
				}
				var strv = varTime.split(":");
				if(strv.length != 2) {
					return false;
				}
				var b = new Date();
				var e = new Date();
				var v = new Date();
				b.setHours(strb[0]);
				b.setMinutes(strb[1]);
				e.setHours(stre[0]);
				e.setMinutes(stre[1]);
				v.setHours(strv[0]);
				v.setMinutes(strv[1]);

				if((v.getTime() - b.getTime() >= 0 && (e.getTime() - v.getTime()) > 0)) {
					return true;
				} else {
					return false;
				}

			}

			function addSong() {
				$("#addsong").click();
			}

			function songlist(file) {

				

			//			 var file = document.getElementById('file');
			//	        
			//	        var fileList = file.files;

			//	        for(var i = 0; i < fileList.length; i++) {
			//				var filePath = file.files[i];
			//		        var reader = new FileReader();
			//		        reader.readAsDataURL(filePath);
			//		        reader.onload = function (e) {
			//		        	$(".img-cont").append("<div class='imgbox'>"+"<img src="+this.result+">"+"<div class='del' onclick='del(this);' ></div></div>");					
			//				}
			//	        }
			//	        
			//	       }
			}
		</script>
		<script type="text/javascript">
			window.onload = function() {
				var index=Math.ceil(Math.random()*17);
				$("body").removeClass();
				$("body").addClass('b_background' + index);
				$("#bgm")[0].src = "";
				$("#bgm")[0].src = "music/bgm" + index + ".mp3";
				$("#bgm")[0].play();
				$(".dg").css("opacity", "0");
				$(".dg").css("display","none");
				
				var dgdiv=document.getElementsByClassName("dg");
				dgdiv[0].remove();
				
				changeStar();
				setInterval("changeStar()",600000);
					
				
				
				//				} else if(time_range("6:00", "12:00", reson)) {
				//					$("body").addClass('b_background3');
				//				} else if(time_range("12:00", "16:00", reson)) {
				//					
				//				} else if(time_range("16:01", "18:30", reson)) {
				//					$("body").addClass('b_background3');
				//				} else if(time_range("18:31", "00:00", reson)) {
				//					$("body").addClass('b_background4');
				//				} else {
				//					alert("xiyule");
				//				}

			}
			
			function changeStar(){
				console.log(111);
				var datetime = new Date();

				var reson = (datetime.getHours() + ":" + datetime.getMinutes());
				console.log(reson);
					if(time_range("18:00", "24:00", reson)||time_range("24:00", "06:00", reson)) {
						
						$("#sun").css("background-image","url(images/moon.png)");
						
					}
			}
		</script>
		<script>
	$(document).ready(function () {
	    var stars = 800;
	    var $stars = $('.stars');
	    var r = 800;
	    for (var i = 0; i < stars; i++) {
	        if (window.CP.shouldStopExecution(1)) {
	            break;
	        }
	        var $star = $('<div/>').addClass('star');
	        $stars.append($star);
	    }
	    window.CP.exitedLoop(1);
	    $('.star').each(function () {
	        var cur = $(this);
	        var s = 0.2 + Math.random() * 1;
	        var curR = r + Math.random() * 300;
	        cur.css({
	            transformOrigin: '0 0 ' + curR + 'px',
	            transform: ' translate3d(0,0,-' + curR + 'px) rotateY(' + Math.random() * 360 + 'deg) rotateX(' + Math.random() * -50 + 'deg) scale(' + s + ',' + s + ')'
	        });
	    });
	});

	</script>
	</body>

</html>
